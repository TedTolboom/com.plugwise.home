<body>
	<center>
		<select id="mySelect">
		</select>
		<button onclick="getOption()">add device
		</button>
	</center>
</body>
	
<script type="text/javascript">
    Homey.setTitle( __('pair.authenticate.stretch.title') );
	
	var devices = [];
	
	Homey.emit('list_appliances', { }, function( err, result ){
		devices = result;
		
		result.forEach(function(entry) {
			console.log(entry.name);
			var x = document.getElementById("mySelect");
			var option = document.createElement("option");
			option.text = entry.name;
			x.add(option);
		});
	});
	
	function getOption(){
		var x = document.getElementById("mySelect").selectedIndex;
		var device = devices[x];
		var stretch = window.found_devices[ window.selected_devices[0] ].data;
		
		Homey.emit('add_device', { device, stretch }, function( err, result ){
			Homey.addDevice({
				data: {
					id: stretch.id,
					stretch: device.data.id,
					password: stretch.password					
				},
				name: device.name
			}, function( err, result ){
				Homey.done();
			});
		});
}
</script>