<body>

	<p data-i18n="pair.auth.smile.find_id"></p>
	<img src="./assets/find_smile_id.jpg" />
	<br/>

	<form id="form" name="form" onsubmit="return getForm()" action="javascript:void(0);" method="post">
		<div class="form-group">
		    <label for="password" data-i18n="pair.auth.smile.id"></label>
		    <input type="text" name="password" id="password" placeholder="" />
		</div>

		<div class="form-group">
		    <input type="submit" value="Login" />
		</div>
	</form>

</body>
	
<script type="text/javascript">
    Homey.setTitle( __('pair.auth.smile.title') );
	
	function getForm(){
		window.found_devices[ window.selected_devices[0] ].data.password = document.forms["form"]["password"].value;

		var smile = window.found_devices[ window.selected_devices[0] ].data;
		
		Homey.emit('connect', { smile }, function( err, result ){
			if (err){
				alert(__('pair.auth.smile.wrong_id'));
			} else {			
				Homey.addDevice({
				    data: {
				        id: smile.id,
						anna: result[0].id,
						password: smile.password,
						ip: smile.ip 					
				    },
				    name: result[0].name
				}, function( err, result ){
				    Homey.done();
				});
			}
		});
	}
</script>